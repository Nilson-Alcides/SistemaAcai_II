@inject SistemaAcai_II.Libraries.Login.LoginColaborador _colaborador
@model IEnumerable<SistemaAcai_II.Models.Comanda>
@{
    ViewData["Title"] = "Painel";
}
<div class="card">
    <div class="card-header bg-primary text-white">
        Vendas da Semana
    </div>
    <div class="card-body">
        <canvas id="graficoVendas"></canvas>
    </div>
</div>

<!-- Gráfico responsivo -->
<div class="w-100" style="overflow-x: auto;">
    <canvas class="my-4" id="myChart" style="max-width: 100%; height: auto;"></canvas>
</div>
 
@* @section Scripts {
    <!-- jQuery deve vir primeiro -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Depois Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Seu código vem depois -->
   
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const ctx = document.getElementById('graficoVendas').getContext('2d');

    const graficoVendas = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'],
            datasets: [{
                label: 'Vendas',
                data: [0, 0, 0, 0, 0, 0, 0],
                backgroundColor: 'rgba(153, 102, 255, 0.7)',
                borderColor: 'rgba(153, 102, 255, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: { beginAtZero: true }
            }
        }
    });

    function atualizarGrafico() {
        $.ajax({
            url: '@Url.Action("ObterDadosGrafico", "Home", new { area = "Admin" })',
            method: 'GET',
            success: function (dados) {
                console.log("Dados recebidos:", dados);
                graficoVendas.data.datasets[0].data = dados;
                graficoVendas.update();
            },
            error: function (xhr) {
                console.error("Erro ao carregar dados do gráfico:", xhr.status);
            }
        });
    }

    $(document).ready(function () {
        atualizarGrafico();
        setInterval(atualizarGrafico, 10000);
    });
</script>
} *@

@section Scripts {
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        const ctx = document.getElementById('graficoVendas').getContext('2d');

        const graficoVendas = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'],
                datasets: [{
                    label: 'Vendas',
                    data: [0, 0, 0, 0, 0, 0, 0],
                    backgroundColor: 'rgba(153, 102, 255, 0.7)',
                    borderColor: 'rgba(153, 102, 255, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });

        function atualizarGrafico() {
            $.ajax({
                url: '@Url.Action("ObterDadosGrafico", "Home", new { area = "Admin" })',
                method: 'GET',
                success: function (dados) {
                    console.log("Dados recebidos:", dados);

                    // Atualiza labels e dados
                    graficoVendas.data.labels = dados.labels;
                    graficoVendas.data.datasets[0].data = dados.valores;

                    graficoVendas.update();
                },
                error: function (xhr) {
                    console.error("Erro ao carregar dados do gráfico:", xhr.status);
                }
            });
        }

        $(document).ready(function () {
            atualizarGrafico();
            setInterval(atualizarGrafico, 10000);
        });
    </script>
}
